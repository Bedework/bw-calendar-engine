<entity-mappings xmlns="http://java.sun.com/xml/ns/persistence/orm"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm_2_0.xsd"
                 version="2.0">
<!--
Put this or the equiv somewhere
 <basic name="openjpa.jdbc.DBDictionary" value="(BooleanRepresentation=STRING_YN)"/>
 -->

  <!-- ===========================================================
       Administrative groups..
       =========================================================== -->

  <entity class="org.bedework.calfacade.svc.BwAdminGroup">
    <table name="bw_adminGroups">
      <unique-constraint name="ag-key">
        <column-name>account</column-name>
      </unique-constraint>
    </table>

    <attributes>
      <id name="id">
        <column name="bw_groupid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="account">
        <column name="account" length="255" nullable="false"/>
      </basic>

      <basic name="principalRef">
        <column name="bw_principal_ref"
                nullable="false" />
      </basic>

      <basic name="description">
        <column name="description"
                length="2000" />
      </basic>

      <basic name="groupOwnerHref">
        <column name="bw_group_owner"
                nullable="false" />
      </basic>

      <basic name="ownerHref">
        <column name="bw_owner"
                nullable="false" />
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>
    </attributes>
  </entity>


  <!-- This is a cheat to get around some problems.

       I was unable to execute that query. Hibernate 3.1 may allow it.
       Rather than build the table names into the java and use direct jdbc
       I added a bogus class and mapped it here.
    -->

  <entity class="org.bedework.calfacade.svc.BwAdminGroupEntry">
    <table name="bw_adminGroupMembers"/>
    <attributes>
      <!-- 3 id fields -->
      <id name="memberId">
        <column name="memberid"/>
      </id>

      <id name="memberIsGroup">
        <column name="member_is_group" />
      </id>

      <many-to-one name="grp" id="true">
        <!-- below I want       foreign-key="bw_agm_ag_fk" -->
        <join-column name="bw_groupid"
                     referenced-column-name="bw_groupid"/>
      </many-to-one>
    </attributes>
  </entity>

  <!-- ===========================================================
     An alarm in Bedework.

     An alarm may be associated with an event or task.

     Alarms may be of different types as defined by the RFC.
       0 -> AUDIO
       1 -> DISPLAY
       2 -> EMAIL
       3 -> PROCEDURE

     If sites want to implement non-standard alarm types use values 1000 and
     greater to define the type. 4-999 are reserved for expansions to the standard

     The following describes the use of each field and when or how required based
     on the trigger type

     Field         Description                                Required Optional
     trigger       This specifies the time for the alarm
                   in rfc format                              ADEP
     trigger_start T if we trigger off the start, 'F' for end          ADEP
     duration      External form of duration                           ADEP
     repeat        number of repitions                                 ADEP
     attach        audio file or attachment or exec              P      A E
     description                                               DE          P
     summary                                                    E
     attendees     Set of attendees                             E

     internal use
     trigger_time  This specifies the time for the next alarm
                   converted to internal format
     previous_trigger  Used to determine if we missed an alarm
     repeat_count  Number of repeats we've done
     expired       Set to 'T' when we're done - default 'F'
     =========================================================== -->

  <entity class="org.bedework.calfacade.BwAlarm">
    <table name="bw_alarms">
    </table>
    <discriminator-value>0</discriminator-value>

    <attributes>
      <id name="id">
        <column name="alarmid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="alarmType">
        <column name="alarm_type"/>
      </basic>

      <basic name="ownerHref">
        <column name="bw_owner"
                nullable="false" />
      </basic>

      <basic name="publick">
        <column name="publick" nullable="false" />
      </basic>

      <basic name="trigger">
        <column name="trigger_rfctime"
                length="16" />
      </basic>

      <basic name="triggerStart">
        <column name="trigger_start" nullable="false" />
      </basic>

      <basic name="duration">
        <column name="duration"
                length="100" />
      </basic>

      <basic name="repeat">
        <column name="repetitions"/>
      </basic>

      <!-- This is inadequate and/or wrong
         It needs to be multiple valued and allow for longer values.
         Also, if a real attachment, it probably ought to be saved as a file and
         this would be a url
         -->
      <basic name="attach">
        <column name="attach"
                length="2000"/>
      </basic>

      <basic name="expired">
        <column name="expired" nullable="false" />
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <many-to-many name="summaries" >
        <join-table name="bw_alarmsummaries">
          <join-column name="bw_alarmid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
        <cascade>
          <cascade-persist/>
          <cascade-merge/>
        </cascade>
      </many-to-many>

      <many-to-many name="descriptions" >
        <join-table name="bw_alarmdescriptions">
          <join-column name="bw_alarmid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
        <cascade>
          <cascade-persist/>
          <cascade-merge/>
        </cascade>
      </many-to-many>

      <many-to-many name="attendees" >
        <join-table name="bw_alarm_attendees">
          <join-column name="alarmid"/>
          <inverse-join-column name="attendeeid"/>
        </join-table>
        <cascade>
          <cascade-persist/>
          <cascade-merge/>
        </cascade>
      </many-to-many>

      <element-collection name="xproperties">
        <order-column name="bwxp_position" />
        <collection-table name="bw_alarm_xprops" >
          <join-column name="alarmid" />
        </collection-table>
      </element-collection>
    </attributes>
  </entity>

  <!-- ==============================================
       Attachments
       ============================================== -->

  <entity class="org.bedework.calfacade.BwAttachment">
    <table name="bw_attachments"/>
    <attributes>
      <id name="id">
        <column name="bwid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="fmtType">
        <column name="bw_fmttype" length="20"/>
      </basic>
      
      <basic name="valueType">
        <column name="bw_valuetype" length="20"/>
      </basic>

      <basic name="encoding">
        <column name="bw_encoding"
                length="2000"/>
      </basic>
      
      <basic name="uri">
        <column name="bw_uri" length="2000"/>
      </basic>

      <basic name="value">
        <column name="bw_value" column-definition="type=text" />
      </basic>
    </attributes>
  </entity>

  <!-- =======================================================
       Attendees
       ======================================================= -->

  <entity class="org.bedework.calfacade.BwAttendee">
    <table name="bw_attendees"/>
    <attributes>
      <id name="id">
        <column name="attendeeid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="cn">
        <column name="cn" length="2000" />
      </basic>

      <basic name="cuType">
        <column name="cutype" length="2000"/>
      </basic>

      <basic name="delegatedFrom">
        <column name="delegated_from"
                length="2000"/>
      </basic>

      <basic name="delegatedTo">
        <column name="delegated_to"
                length="2000"/>
      </basic>

      <basic name="dir">
        <column name="dir" length="2000"/>
      </basic>

      <basic name="language">
        <column name="lang" length="100"/>
      </basic>

      <basic name="member">
        <column name="member" length="2000"/>
      </basic>

      <basic name="rsvp"/>

      <basic name="role">
        <column name="role" length="200"/>
      </basic>

      <basic name="partstat">
        <column name="partstat" length="100"/>
      </basic>

      <basic name="sentByVal">
        <column name="sent_by" length="2000"/>
      </basic>

      <basic name="attendeeUri">
        <column name="attendee_uri" length="2000"/>
      </basic>

      <basic name="sequence">
        <column name="rfcsequence"/>
      </basic>

      <basic name="scheduleAgent">
        <column name="bw_sched_agent"/>
      </basic>

      <basic name="scheduleStatus">
        <column name="bw_sched_status" length="100"/>
      </basic>

      <basic name="dtstamp">
        <column name="dtstamp" length="16" />
      </basic>
    </attributes>
  </entity>

  <!-- =========================================================
     object to represent an authorised calendar user - that is a user
     with some special privilege. This could also be represented by users
     with roles in a directory.

     NOTE: I believe the constraint on the id requires we create the user
     first and have an embedded user entry - or at least have an
     embedded entry which hibernate will create.
     ========================================================= -->

  <entity class="org.bedework.calfacade.svc.BwAuthUser">
    <table name="bw_auth"/>
    <attributes>
      <id name="id">
        <column name="userid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="userHref">
        <column name="bw_user"
                nullable="false" />
      </basic>

      <basic name="usertype">
        <column name="usertype"/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <embedded name="prefs"/>
    </attributes>
  </entity>


  <!-- This is a cheat to get around some problems. I cannot delete all
       references to a given contact, location etc in one update.
       SQL allows it - delete from authprefContacts where contactid=?

       I was unable to execute that query. Hibernate 3.1 may allow it.
       Rather than build the table names into the java and use direct jdbc
       I added a bogus class and mapped it here.
    -->

  <entity class="org.bedework.calfacade.svc.prefs.BwAuthUserPrefsCategory">
    <table name="bw_authprefCategories"/>
    <attributes>
      <id name="id">
        <column name="userid"/>
      </id>

      <basic name="categoryid">
        <column name="categoryid" nullable="false"/>
      </basic>
    </attributes>
  </entity>


  <entity class="org.bedework.calfacade.svc.prefs.BwAuthUserPrefsLocation">
    <table name="bw_authprefLocations"/>
    <attributes>
      <id name="id">
        <column name="userid" />
      </id>
      <basic name="locationid">
        <column name="locationid" nullable="false"/>
      </basic>
    </attributes>
  </entity>

  <entity class="org.bedework.calfacade.svc.prefs.BwAuthUserPrefsContact">
    <table name="bw_authprefContacts"/>
    <attributes>
      <id name="id">
        <column name="userid"/>
      </id>
      <basic name="contactid">
        <column name="contactid" nullable="false"/>
      </basic>
    </attributes>
  </entity>

  <entity class="org.bedework.calfacade.svc.prefs.BwAuthUserPrefsCalendar">
    <table name="bw_authprefCalendars"/>
    <attributes>
      <id name="id">
        <column name="userid"/>
      </id>
      <basic name="calendarid">
        <column name="calendarid" nullable="false"/>
      </basic>
    </attributes>
  </entity>

  <!-- =========================================================
                           Calendar Suites
       ========================================================= -->

  <entity class="org.bedework.calfacade.svc.BwCalSuite">
    <table name="bw_calsuites"/>
    <attributes>
      <id name="id">
        <column name="csid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="creatorHref">
        <column name="bw_creator"/>
      </basic>

      <basic name="ownerHref">
        <column name="bw_owner"/>
      </basic>

      <basic name="access">
        <column name="bwaccess" length="3900" />
      </basic>

      <basic name="publick">
        <column name="publick" nullable="false" />
      </basic>

      <basic name="name">
        <column name="csname" nullable="false"
                length="255" unique="true" />
      </basic>

      <basic name="fields1">
        <column name="bw_root_collection" length="3000"/>
      </basic>

      <basic name="fields2">
        <column name="bw_submissions_root" length="3000"/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <many-to-one name="group">
        <join-column name="groupid" nullable="false"/>
      </many-to-one>
    </attributes>
  </entity>

  <!-- =========================================================
       A calendar definition in Bedework.
       ========================================================= -->

  <entity class="org.bedework.calfacade.BwCollection">
    <table name="bw_calendars" />
    <attributes>
      <id name="id">
        <column name="id"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="creatorHref">
        <column name="bw_creator"/>
      </basic>

      <basic name="ownerHref">
        <column name="bw_owner"/>
      </basic>

      <basic name="access">
        <column name="bwaccess"
                length="3900" />
      </basic>

      <basic name="publick">
        <column name="publick" nullable="false" />
      </basic>

      <!-- This should be considered an internal, probably immutable name and
         we use the display name in the ui.
         Caldav may present the displayname -->
      <basic name="name">
        <column name="calname"
                length="100" nullable="false" />
        <!-- unique-key="cal-sibling-names" -->
      </basic>

      <!-- I wanted to specify unique="true" on this but mysql complains.
         This is also probably too short.

         For uniqueness maybe limit the length of the name and create a
         unique key on the parent + name
      -->
      <basic name="path">
        <column name="bwpath" length="3000"
                nullable="false"/>
      </basic>

      <basic name="colPath">
        <column name="bw_col_path" length="3000"/>
      </basic>

      <!-- These need changing. Perhaps recast summary as displayNames
           Both need to be multi-language.
           For the moment limit the lengtgh for Oracle -->
      <basic name="summary">
        <column name="summary" length="500" />
      </basic>

      <basic name="description">
        <column name="description" length="1000" />
      </basic>

      <basic name="mailListId">
        <column name="mail_list_id"
                length="200" />
      </basic>

      <basic name="calType">
        <column name="caltype" nullable="false"/>
      </basic>

      <basic name="created">
        <column name="bw_created" length="16" nullable="false" />
      </basic>

      <basic name="filterExpr">
        <column name="bw_filterexpr" column-definition="type=text"/>
      </basic>

      <basic name="aliasUri">
        <column name="bw_alias_uri" length="500" />
      </basic>

      <basic name="display">
        <column name="display" nullable="false" />
      </basic>

      <basic name="affectsFreeBusy">
        <column name="affects_free_busy" nullable="false" />
      </basic>

      <basic name="ignoreTransparency">
        <column name="ignore_transparency" nullable="false" />
      </basic>

      <basic name="unremoveable">
        <column name="unremoveable" nullable="false" />
      </basic>

      <!--  Properties associated with remote subscriptions -->
      <basic name="refreshRate">
        <column name="bwrefreshseconds"/>
      </basic>

      <basic name="lastRefresh">
        <column name="bwlastrefresh" length="16" />
      </basic>

      <basic name="lastEtag">
        <column name="bwlastetag" length="256" />
      </basic>

      <basic name="remoteId">
        <column name="bwrid" length="256" />
      </basic>

      <basic name="remotePw">
        <column name="bwrpw" length="500" />
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <one-to-one name="lastmod" orphan-removal="true"/>

      <many-to-many name="categories">
        <join-table name="bw_calendar_categories">
          <join-column name="calendarid"/>
          <inverse-join-column name="categoryid"/>
        </join-table>
      </many-to-many>

      <element-collection name="properties">
        <collection-table name="bw_calendar_properties" >
          <join-column name="bwid" />
        </collection-table>
      </element-collection>
    </attributes>
  </entity>

  <!-- =======================================================
       Collection last mod
       ======================================================= -->

  <entity class="org.bedework.calfacade.BwCollectionLastmod">
    <table name="bw_collection_lastmods" />

    <attributes>
      <id name="id">
        <column name="bw_id"/>
      </id>

      <basic name="path">
        <column name="bwpath" length="3000"
                nullable="false"/>
      </basic>

      <basic name="timestamp" >
        <column name="bw_timestamp" length="16" nullable="false" />
      </basic>

      <basic name="sequence">
        <column name="bw_sequence"/>
      </basic>

      <one-to-one name="dbEntity" maps-id="id"/>
    </attributes>
  </entity>

  <!-- =========================================================
       A category in Bedework
       ========================================================= -->

  <entity class="org.bedework.calfacade.BwCategory">
    <table name="bw_categories"/>

    <attributes>
      <id name="id">
        <column name="categoryid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="creatorHref">
        <column name="bw_creator"/>
      </basic>

      <basic name="ownerHref">
        <column name="bw_owner"/>
      </basic>

      <basic name="access">
        <column name="bwaccess"
                length="3900" />
      </basic>

      <basic name="publick">
        <column name="publick" nullable="false" />
      </basic>

      <basic name="uid">
        <column name="bw_uid" length="50"
                unique="true"
                nullable="false"/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <many-to-one name="word">
        <join-column name="bw_catwdid" unique="true" nullable="false"/>
      </many-to-one>

      <many-to-one name="description">
        <join-column name="bw_catdescid" unique="true" nullable="false"/>
      </many-to-one>
    </attributes>
  </entity>

  <!-- =========================================================
       Object representing contacts
       ========================================================= -->

  <entity class="org.bedework.calfacade.BwContact">
    <table name="bw_contacts"/>

    <attributes>
      <id name="id">
        <column name="entityid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="creatorHref">
        <column name="bw_creator"/>
      </basic> 

      <basic name="ownerHref">
        <column name="bw_owner"/>
      </basic> 

      <basic name="access">
        <column name="bwaccess"
                length="3900" />
      </basic> 

      <basic name="publick">
        <column name="publick" nullable="false" />
      </basic>

      <basic name="uid">
        <column name="bw_uid" length="50"
              unique="true"
              nullable="false"/>
      </basic>

      <basic name="phone">
        <column name="bw_phone"/>
      </basic>

      <basic name="email">
        <column name="bw_email"/>
      </basic>

      <basic name="link">
        <column name="bw_link"
                length="500" />
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <many-to-one name="cn">
        <join-column name="bw_connameid" unique="true" nullable="false"/>
      </many-to-one>
    </attributes>
  </entity>

  <!-- ===================================================================
     An Event in Bedework.
     =================================================================== -->

  <entity class="org.bedework.calfacade.BwEventObj">
    <table name="bw_events"/>

    <attributes>
      <id name="id">
        <column name="eventid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="entityType">
        <column name="bw_entity_type"/>
      </basic> 

      <basic name="colPath">
        <column name="bw_col_path" length="3000"
                nullable="false"/>
      </basic>

      <!-- (ownerid +) calendarid + uid + recurrence-id is usually a unique key. -->
      <basic name="uid">
        <column name="bw_uid" length="1000"/>
      </basic> 

      <basic name="name">
        <column name="eventname" length="500"/>
      </basic> 

      <basic name="creatorHref">
        <column name="bw_creator"/>
      </basic> 

      <basic name="ownerHref">
        <column name="bw_owner"/>
      </basic> 

      <basic name="access">
        <column name="bwaccess"
                length="3900" />
      </basic> 

      <basic name="publick">
        <column name="publick" nullable="false" />
      </basic>

      <basic name="duration">
        <column name="duration" />
      </basic> 

      <basic name="endType">
        <column name="end_type" nullable="false" />
      </basic> 

      <basic name="noStart">
        <column name="bw_nostart" nullable="false" />
      </basic> 

      <basic name="deleted">
        <column name="bw_deleted" nullable="false"/>
      </basic>

      <basic name="tombstoned">
        <column name="bwtombstoned" nullable="false"/>
      </basic>

      <basic name="status" />

      <basic name="classification">
        <column name="bw_class" length="250" />
      </basic>

      <basic name="link">
        <column name="bw_link" length="500" />
      </basic>

      <basic name="cost">
        <column name="cost"/>
      </basic>

      <basic name="dtstamp">
        <column name="bw_dtstamp" length="16" />
      </basic>

      <basic name="lastmod" >
        <column name="bw_lastmod" length="16" nullable="false" />
      </basic>

      <basic name="created">
        <column name="bw_created" length="16" nullable="false" />
      </basic>

      <basic name="stag" >
        <column name="bw_stag" length="21" />
      </basic>

      <basic name="priority">
        <column name="priority" />
      </basic>

      <basic name="sequence">
        <column name="rfcsequence"/>
      </basic>

      <basic name="transparency">
        <column name="transparency" length="100" />
      </basic>

      <!-- task only -->
      <basic name="percentComplete">
        <column name="percent_complete"/>
      </basic>

      <basic name="completed">
        <column name="completed" length="16" />
      </basic>

      <basic name="recurring">
        <column name="recurring" nullable="false"/>
      </basic>

      <basic name="recurrenceId">
        <column name="recurrence_id"
                length="16" />
      </basic>

      <basic name="ctoken">
        <column name="latest_date"/>
      </basic>

      <basic name="scheduleMethod">
        <column name="schedule_method"/>
      </basic>

      <basic name="originator">
        <column name="originator" />
      </basic>

      <basic name="scheduleState">
        <column name="schedule_state"/>
      </basic>

      <basic name="organizerSchedulingObject">
        <column name="bw_org_scheduleobj" nullable="false"/>
      </basic>

      <basic name="attendeeSchedulingObject">
        <column name="bw_att_scheduleobj" nullable="false"/>
      </basic>

      <basic name="busyType">
        <column name="busy_type"/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <many-to-one name="location">
        <join-column name="locationid"/>
      </many-to-one>

      <many-to-many name="summaries">
        <join-table name="bw_event_summaries">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="descriptions">
        <join-table name="bw_event_descriptions">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="comments">
        <join-table name="bw_event_comments">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="contacts">
        <join-table name="bw_event_contacts">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="contactid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="resources">
        <join-table name="bw_event_resources">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="categories">
        <join-table name="bw_event_categories">
          <join-column name="eventid"/>
          <inverse-join-column name="categoryid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="alarms">
        <join-table name="bw_entity_alarms">
          <join-column name="eventid"/>
          <inverse-join-column name="alarmid"/>
        </join-table>
        <cascade>
          <cascade-all/>
        </cascade>
      </many-to-many>

      <many-to-many name="attachments">
        <join-table name="bw_entity_attachments">
          <join-column name="eventid"/>
          <inverse-join-column name="attachid"/>
        </join-table>
        <cascade>
          <cascade-all/>
        </cascade>
      </many-to-many>

      <many-to-many name="attendees" >
        <join-table name="bw_event_attendees">
          <join-column name="eventid"/>
          <inverse-join-column name="attendeeid"/>
        </join-table>
        <cascade>
          <cascade-persist/>
          <cascade-merge/>
        </cascade>
      </many-to-many>

      <element-collection name="rrules" fetch="EAGER"
                          target-class="java.lang.String">
        <column name="rrule" nullable="false" length="255"/>
        <collection-table name="bw_event_rrules">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="rdates">
        <collection-table name="bw_event_rdates">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="exrules" fetch="EAGER"
                          target-class="java.lang.String">
        <column name="exrule" nullable="false" length="255"/>
        <collection-table name="bw_event_exrules">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="exdates">
        <collection-table name="bw_event_exdates">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="recipients" fetch="EAGER"
                          target-class="java.lang.String">
        <column name="recipient" nullable="false" length="255"/>
        <collection-table name="bw_event_recipients">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="requestStatuses">
        <collection-table name="bw_rstatus">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="xproperties">
        <order-column name="bwxp_position" />
        <collection-table name="bw_event_xprops" >
          <join-column name="bw_eventid" />
        </collection-table>
      </element-collection>

      <!-- =============== Freebusy =============== -->

      <element-collection name="freeBusyPeriods" fetch="LAZY">
        <order-column name="fbcomp_position"/>
        <collection-table name="bw_fbcomp" >
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

    <!-- =============== Vavailability =============== -->

      <element-collection name="availableUids" fetch="LAZY"
                          target-class="java.lang.String">
        <column name="avluid" nullable="false" length="255"/>
        <collection-table name="bw_event_availuids">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <embedded name="geo" />

      <embedded name="relatedTo"/>

      <embedded name="organizer"/>

      <embedded name="dtstart">
        <attribute-override name="dateType">
          <column name="start_date_type"/>
        </attribute-override>

        <attribute-override name="timezoneId">
          <column name="start_tzid" />
        </attribute-override>

        <attribute-override name="dtval">
          <column name="start_dtval" length="16" />
        </attribute-override>

        <attribute-override name="date">
          <column name="start_date" length="16"/>
        </attribute-override>

        <attribute-override name="floatFlag">
          <column name="bw_start_floating"/>
        </attribute-override>
      </embedded>

      <!-- All day events and events which end when they start have no
         end date/time -->
      <embedded name="dtend">
        <attribute-override name="dateType">
          <column name="end_date_type"/>
        </attribute-override>

        <attribute-override name="timezoneId">
          <column name="end_tzid" />
        </attribute-override>

        <attribute-override name="dtval">
          <column name="end_dtval" length="16" />
        </attribute-override>

        <attribute-override name="date">
          <column name="end_date" length="16"/>
        </attribute-override>

        <attribute-override name="floatFlag">
          <column name="bw_end_floating"/>
        </attribute-override>
      </embedded>
    </attributes>
  </entity>


  <!--
  <database-object>
    <create>
        CREATE INDEX BW_EVENT_CAL_NAME ON BW_EVENTS(
    </create>
    <drop>
        [DROP statement]
    </drop>
    <dialect-scope name="org.hibernate.dialect.Oracle9Dialect"/>
    <dialect-scope name="org.hibernate.dialect.OracleDialect"/>
  </database-object>
  -->


<!-- ===================================================================
     An Event Annotation in Bedework.
     This refers to another event (possibly also an annotation) and holds
     changes to that event.

     This definition differs from The event definition only in that all
     fields (except the index and sequence) may be null and the event does
     not have a reference to another event.
     =================================================================== -->

  <entity class="org.bedework.calfacade.BwEventAnnotation">
    <table name="bw_event_annotations"/>

    <attributes>
      <id name="id">
        <column name="eventid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="entityType">
        <column name="bw_entity_type"/>
      </basic>

      <basic name="colPath">
        <column name="bw_col_path" length="3000"
                nullable="false"/>
      </basic>

      <basic name="name">
        <column name="eventname" length="500" />
      </basic>

      <!-- calendar + uid + recurrence-id is usually a unique key. -->
      <basic name="uid">
        <column name="bw_uid" length="1000" />
      </basic>

      <basic name="creatorHref">
        <column name="bw_creator"/>
      </basic>

      <basic name="ownerHref">
        <column name="bw_owner"/>
      </basic>

      <basic name="access">
        <column name="bwaccess"
                length="3900" />
      </basic>

      <basic name="publick">
        <column name="publick" />
      </basic>

      <basic name="duration">
        <column name="duration" />
      </basic>

      <basic name="endType">
        <column name="end_type"/>
      </basic>

      <basic name="noStart">
        <column name="bw_nostart" />
      </basic>

      <basic name="deleted">
        <column name="bw_deleted"/>
      </basic>

      <basic name="tombstoned">
        <column name="bwtombstoned" nullable="false"/>
      </basic>

      <basic name="classification">
        <column name="bw_class" length="250" />
      </basic>

      <basic name="link">
        <column name="bw_link" length="500" />
      </basic>

      <basic name="status" />

      <basic name="cost">
        <column name="cost"/>
      </basic>

      <basic name="dtstamp">
        <column name="bw_dtstamp" length="16" />
      </basic>

      <basic name="lastmod" >
        <column name="bw_lastmod" length="16" />
      </basic>

      <basic name="created">
        <column name="bw_created" length="16" />
      </basic>

      <basic name="stag" >
        <column name="bw_stag" length="21" />
      </basic>

      <basic name="priority">
        <column name="priority" />
      </basic>

      <basic name="sequence">
        <column name="rfcsequence"/>
      </basic>

      <basic name="transparency">
        <column name="transparency" length="100" />
      </basic>

      <!-- task only -->
      <basic name="percentComplete">
        <column name="percent_complete"/>
      </basic>

      <basic name="completed">
        <column name="completed" length="16" />
      </basic>

      <basic name="recurring">
        <column name="recurring"/>
      </basic>

      <basic name="recurrenceId">
        <column name="recurrence_id"
                length="16" />
      </basic>

      <basic name="ctoken">
        <column name="latest_date"/>
      </basic>

      <basic name="scheduleMethod">
        <column name="schedule_method"/>
      </basic>

      <basic name="originator">
        <column name="originator" />
      </basic>

      <basic name="scheduleState">
        <column name="schedule_state"/>
      </basic>

      <basic name="override">
        <column name="bw_override" nullable="false" />
      </basic>

      <!-- Empty Collection flags -->

      <basic name="emptyFlags">
        <column name="bw_empty_flags" length="200" />
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <!-- We probably shouldn't do this. For target and master events we
         need to allow the target event to be deleted and then inform the
         user if they disappear.
      -->
      <many-to-one name="target">
        <join-column name="targetid" />
      </many-to-one>

      <many-to-one name="master">
        <join-column name="masterid" />
      </many-to-one>

      <many-to-one name="location">
        <join-column name="locationid"/>
      </many-to-one>

      <many-to-many name="summaries">
        <join-table name="bw_eventann_summaries">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="descriptions">
        <join-table name="bw_eventann_descriptions">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="comments">
        <join-table name="bw_eventann_comments">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="contacts">
        <join-table name="bw_eventann_contacts">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="contactid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="resources">
        <join-table name="bw_eventann_resources">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="categories">
        <join-table name="bw_eventann_categories">
          <join-column name="eventid"/>
          <inverse-join-column name="categoryid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="alarms">
        <join-table name="bw_eventann_alarms">
          <join-column name="eventid"/>
          <inverse-join-column name="alarmid"/>
        </join-table>
        <cascade>
          <cascade-all/>
        </cascade>
      </many-to-many>

      <many-to-many name="attachments">
        <join-table name="bw_eventann_attachments">
          <join-column name="eventid"/>
          <inverse-join-column name="attachid"/>
        </join-table>
        <cascade>
          <cascade-all/>
        </cascade>
      </many-to-many>

      <many-to-many name="attendees" >
        <join-table name="bw_eventann_attendees">
          <join-column name="eventid"/>
          <inverse-join-column name="attendeeid"/>
        </join-table>
        <cascade>
          <cascade-persist/>
          <cascade-merge/>
        </cascade>
      </many-to-many>

      <element-collection name="requestStatuses">
        <collection-table name="bw_eventann_rstatus">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="rrules" fetch="EAGER"
                          target-class="java.lang.String">
        <column name="rrule" nullable="false" length="255"/>
        <collection-table name="bw_eventann_rrules">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="rdates">
        <collection-table name="bw_eventann_rdates">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="exrules" fetch="EAGER"
                          target-class="java.lang.String">
        <column name="exrule" nullable="false" length="255"/>
        <collection-table name="bw_eventann_exrules">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="exdates">
        <collection-table name="bw_eventann_exdates">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="recipients" fetch="EAGER"
                          target-class="java.lang.String">
        <column name="recipient" nullable="false" length="255"/>
        <collection-table name="bw_eventann_recipients">
          <join-column name="eventid"/>
        </collection-table>
      </element-collection>

      <element-collection name="xproperties">
        <order-column name="bwxp_position" />
        <collection-table name="bw_eventann_xprops" >
          <join-column name="bw_eventannid" />
        </collection-table>
      </element-collection>

      <embedded name="geo"/>

      <embedded name="organizer"/>

      <embedded name="relatedTo"/>

      <embedded name="dtstart" >
        <attribute-override name="dateType">
          <column name="start_date_type"/>
        </attribute-override>

        <attribute-override name="timezoneId">
          <column name="start_tzid" />
        </attribute-override>

        <attribute-override name="dtval">
          <column name="start_dtval" length="16"/>
        </attribute-override>

        <attribute-override name="date">
          <column name="start_date" length="16"/>
        </attribute-override>

        <attribute-override name="floatFlag">
          <column name="bw_start_floating"/>
        </attribute-override>
      </embedded>

      <!-- All day events and events which end when they start have no
         end date/time -->
      <embedded name="dtend" >
        <attribute-override name="dateType">
          <column name="end_date_type"/>
        </attribute-override>

        <attribute-override name="timezoneId">
          <column name="end_tzid" />
        </attribute-override>

        <attribute-override name="dtval">
          <column name="end_dtval" length="16" />
        </attribute-override>

        <attribute-override name="date">
          <column name="end_date" length="16"/>
        </attribute-override>

        <attribute-override name="floatFlag">
          <column name="bw_end_floating"/>
        </attribute-override>
      </embedded>
    </attributes>
  </entity>

  <!-- =========================================================
       A filter definition is an xml string with an associated
       internal name, a set of display names and descriptions
       ========================================================= -->

  <entity class="org.bedework.calfacade.BwFilterDef">
    <table name="bw_filters"/>
    <attributes>
      <id name="id">
        <column name="filterid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="ownerHref">
        <column name="bw_owner"/>
      </basic>

      <basic name="publick">
        <column name="publick" nullable="false" />
      </basic>

      <basic name="name" >
        <column name="filtername" length="200" />
      </basic>

      <basic name="definition">
        <column name="bwdefinition" column-definition="type=text"/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <many-to-many name="displayNames">
        <join-table name="bw_filter_display_names">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>

      <many-to-many name="descriptions">
        <join-table name="bw_filter_descriptions">
          <join-column name="bw_eventid"/>
          <inverse-join-column name="bw_strid"/>
        </join-table>
      </many-to-many>
    </attributes>
  </entity>

  <!-- ==================================================
       Groups stored in the db - most sites will probably use an external
       directory but this is useful for debugging
       =================================================== -->

  <entity class="org.bedework.calfacade.BwGroup">
    <table name="bw_groups"/>
    <attributes>
      <id name="id">
        <column name="bw_group_id"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="account">
        <column name="bw_account" length="200"
                nullable="false"
                unique="true"/>
      </basic>

      <basic name="principalRef">
        <column name="bw_principal_ref" nullable="false" />
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>
    </attributes>
  </entity>

  <!-- This is a cheat to get around some problems.

       I was unable to execute that query. Hibernate 3.1 may allow it.
       Rather than build the table names into the java and use direct jdbc
       I added a bogus class and mapped it here.
    -->

  <entity class="org.bedework.calfacade.BwGroupEntry">
    <table name="bw_group_Members"/>

    <attributes>
      <id name="memberId">
        <column name="memberid"/>
      </id>

      <id name="memberIsGroup">
        <column name="member_is_group" />
      </id>

      <basic name="groupId">
        <column name="groupid" insertable="false" updatable="false"/>
      </basic>

      <many-to-one name="grp" id="true">
        <join-column name="groupid" />
      </many-to-one>
    </attributes>
  </entity>

  <!-- =========================================================
       Object representing the location of an event
       ========================================================= -->

<entity class="org.bedework.calfacade.BwLocation">
  <table name="bw_locations" />

    <attributes>
      <id name="id">
        <column name="entityid"/>
      <sequence-generator name="hibernate_sequence" />
    </id>

    <basic name="creatorHref">
        <column name="bw_creator"/>
    </basic> 

    <basic name="ownerHref">
        <column name="bw_owner"/>
    </basic> 

    <basic name="access">
        <column name="bwaccess"
              length="3900" />
    </basic> 

    <basic name="publick">
      <column name="publick" nullable="false" />
    </basic>

    <basic name="uid">
        <column name="bw_uid" length="50"
              unique="true"
              nullable="false"/>
    </basic>

      <basic name="link">
        <column name="bw_link" length="500"/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

    <many-to-one name="address">
      <join-column name="bw_locaddrid" unique="true" nullable="false"/>
      <cascade>
        <cascade-all/>
      </cascade>
    </many-to-one>

    <many-to-one name="subaddress">
      <join-column name="bw_locsubaddrid" unique="true" nullable="false"/>
      <cascade>
        <cascade-all/>
      </cascade>
    </many-to-one>
  </attributes>
  </entity>

<!-- ===================================================================
     A long string in Bedework. There are restrictions on the use of such
     String values with hibernate and some db systems, e.g. Oracle.
     =================================================================== -->

<entity class="org.bedework.calfacade.BwLongString">
  <table name="bw_longstrings"/>

    <attributes>
      <id name="id">
        <column name="bw_id"/>
      <sequence-generator name="hibernate_sequence" />
    </id>

    <basic name="lang">
        <column name="bw_lang" length="100" />
    </basic>

    <basic name="value">
        <column name="bw_value" column-definition="type=text"/>
    </basic>

    <version name="seq">
        <column name="bwseq"/>
     </version>
  </attributes>
  </entity>

  <!-- =========================================================
       Object to represent calendar user preferences.
       ========================================================= -->

<entity class="org.bedework.calfacade.svc.BwPreferences">
  <table name="bw_preferences" />
    <attributes>
      <id name="id">
        <column name="prefid"/>
      <sequence-generator name="hibernate_sequence" />
    </id>

      <basic name="ownerHref">
        <column name="bw_owner" unique="true" nullable="false" />
      </basic>

      <basic name="email">
        <column name="email" />
      </basic>

      <basic name="defaultCalendarPath">
        <column name="bw_default_calendar"
                length="3900" />
      </basic>

      <basic name="skinName">
        <column name="skin_name" />
      </basic>

      <basic name="skinStyle">
        <column name="skin_style" />
      </basic>

      <basic name="preferredView">
        <column name="preferred_view" />
      </basic>

      <basic name="preferredViewPeriod">
        <column name="preferred_view_period" />
      </basic>

      <basic name="pageSize">
        <column name="bw_page_size"/>
      </basic>

      <basic name="workDays">
        <column name="workdays" />
      </basic>

      <basic name="workdayStart">
        <column name="workday_start"/>
      </basic>

      <basic name="workdayEnd">
        <column name="workday_end"/>
      </basic>

      <basic name="preferredEndType">
        <column name="preferred_endtype" />
      </basic>

      <basic name="userMode">
        <column name="bwuser_mode"/>
      </basic>

      <basic name="hour24">
        <column name="bw_hour24" nullable="false" />
      </basic>

      <basic name="scheduleAutoRespond">
        <column name="bw_sched_autoresp" nullable="false" />
      </basic>

      <basic name="scheduleAutoCancelAction">
        <column name="bw_sched_autocancelaction"/>
      </basic>

      <basic name="scheduleDoubleBook">
        <column name="bw_sched_double_book" nullable="false" />
      </basic>

      <basic name="scheduleAutoProcessResponses">
        <column name="bw_sched_autoproc_resp"/>
      </basic>

    <version name="seq">
        <column name="bwseq"/>
     </version>

      <many-to-many name="views" fetch="EAGER">
        <join-table name="bw_user_views">
          <join-column name="prefid"/>
          <inverse-join-column name="elt"/>
        </join-table>
        <cascade>
          <cascade-all/>
        </cascade>
      </many-to-many>

      <element-collection name="properties">
        <collection-table name="bw_user_properties" >
          <join-column name="bwid" />
        </collection-table>
      </element-collection>
    </attributes>
  </entity>

  <!-- =========================================================
       A resource definition in Bedework.
       ========================================================= -->

  <entity class="org.bedework.calfacade.BwResource">
    <table name="bw_resources"/>
    <attributes>
      <id name="id">
        <column name="id"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="colPath">
        <column name="bw_col_path" length="3000"
                nullable="false"/>
      </basic>

      <basic name="creatorHref">
        <column name="bw_creator"/>
      </basic>

      <basic name="ownerHref">
        <column name="bw_owner"/>
      </basic>

      <basic name="access">
        <column name="bwaccess"
                length="3900" />
      </basic>

      <basic name="publick">
        <column name="publick" nullable="false" />
      </basic>

      <basic name="name">
        <column name="bwname"
                length="100" nullable="false" />
      </basic>

      <basic name="created">
        <column name="bw_created" length="16" nullable="false" />
      </basic>

      <basic name="lastmod" >
        <column name="bw_lastmod" length="16" nullable="false" />
      </basic>

      <basic name="sequence">
        <column name="bwsequence"/>
      </basic>

      <basic name="contentType">
        <column name="bw_contenttype" length="1000"/>
      </basic>

      <basic name="encoding">
        <column name="bw_encoding"
                length="1000"/>
      </basic>

      <basic name="contentLength">
        <column name="bwcontent_length"/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>
    </attributes>
  </entity>

  <!-- ===================================================================
     A resource content definition in Bedework.
     =================================================================== -->

  <entity class="org.bedework.calfacade.BwResourceContent">
    <table name="bw_resource_contents"/>
    <attributes>
      <id name="id">
        <column name="id"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="colPath">
        <column name="bw_col_path" length="3000"/>
      </basic>

      <basic name="name">
        <column name="bwname"
                length="100" nullable="false" />
      </basic>

      <basic name="byteValue">
        <column name="bw_value"/>
        <lob/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>
    </attributes>
  </entity>

  <!-- =========================================================
       A string in Bedework
       ========================================================= -->

  <entity class="org.bedework.calfacade.BwString">
    <table name="bw_strings"/>

    <attributes>
      <id name="id">
        <column name="bw_id"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="lang">
        <column name="bw_lang" length="100" />
      </basic>

      <!--<basic name="value">
        <column name="bw_value"/>
         <type="text"/>-->
      <basic name="value">
        <column name="bw_value" length="3900" />
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>
    </attributes>
  </entity>

  <!-- ===================================================================
     Object representing the system parameters
     =================================================================== -->

  <entity class="org.bedework.calfacade.BwSystem">
    <table name="bw_settings"/>
    <attributes>
      <id name="id">
        <column name="id"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="name">
        <column name="bwname" length="200" />
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <element-collection name="properties">
        <collection-table name="bw_system_properties" >
          <join-column name="bwid" />
        </collection-table>
      </element-collection>
    </attributes>
  </entity>


<!-- ===================================================================
     Object to represent a calendar user. These are also the owners of
     events in the database.

     It would probably be a good thing to define this class with
     lazy="true". However this adds extra complication to the interface
     requiring explicit initializations at various places.
     =================================================================== -->

  <entity class="org.bedework.calfacade.BwUser">
    <table name="bw_users" />
    <attributes>
      <id name="id">
        <column name="userid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="account">
        <column name="bw_account" length="200" nullable="false"
                unique="true" />
      </basic>

      <basic name="principalRef">
        <column name="bw_principal_ref"
                nullable="false" />
      </basic>

      <basic name="instanceOwner">
        <column name="instance_owner" nullable="false" />
      </basic>

      <basic name="created">
        <column name="bw_created"/>
      </basic>

      <basic name="logon">
        <column name="bw_last_logon"/>
      </basic>

      <basic name="lastAccess">
        <column name="bw_last_access"/>
      </basic>

      <basic name="lastModify">
        <column name="bw_last_modify"/>
      </basic>

      <basic name="categoryAccess">
        <column name="bw_category_access" length="3900" />
      </basic>

      <basic name="contactAccess">
        <column name="bw_contact_access" length="3900" />
      </basic>

      <basic name="locationAccess">
        <column name="bw_location_access" length="3900" />
      </basic>

      <basic name="quota">
        <column name="bw_quota"/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>
    </attributes>
  </entity>

  <!-- =======================================================
       Views
       ======================================================= -->

  <entity class="org.bedework.calfacade.svc.BwView">
    <table name="bw_views"/>

    <attributes>
      <id name="id">
        <column name="viewid"/>
        <sequence-generator name="hibernate_sequence" />
      </id>

      <basic name="name">
        <column name="viewname"
                length="100" nullable="false"/>
      </basic>

      <version name="seq">
        <column name="bwseq"/>
      </version>

      <element-collection name="collectionPaths"
                          target-class="java.lang.String">
        <order-column name="bw_path_positon"/>
        <column name="bw_calpath" nullable="false"/>
        <collection-table name="bw_view_collections">
          <join-column name="viewid"/>
        </collection-table>
      </element-collection>
    </attributes>
  </entity>

  <embeddable class="org.bedework.calfacade.BwProperty">
    <attributes>
      <basic name="name">
        <column name="bw_name" length="200" />
      </basic>

      <basic name="value">
        <column name="bw_value" column-definition="type=text"/>
      </basic>
    </attributes>
  </embeddable>
  <embeddable class="org.bedework.calfacade.BwXproperty">
    <attributes>
      <basic name="name" >
        <column name="bw_name" length="100"  />
      </basic>

      <basic name="pars">
        <column name="bw_pars" length="4000"  />
      </basic>

      <basic name="value">
        <column name="bw_value" column-definition="type=text"/>
      </basic>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.svc.prefs.CategoryPref" >
    <attributes>
      <basic name="autoAdd" >
        <column name="autoaddCategories" nullable="false" />
      </basic>

      <many-to-many name="preferred">
        <join-table name="bw_authprefCategories">
          <join-column name="userid"/>
          <inverse-join-column name="categoryid"/>
        </join-table>
      </many-to-many>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.svc.prefs.LocationPref" >
    <attributes>
      <basic name="autoAdd" >
        <column name="autoaddLocations" nullable="false" />
      </basic>

      <many-to-many name="preferred">
        <join-table name="bw_authprefLocations">
          <join-column name="userid"/>
          <inverse-join-column name="locationid"/>
        </join-table>
      </many-to-many>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.svc.prefs.ContactPref" >
    <attributes>
      <basic name="autoAdd" >
        <column name="autoaddContacts" nullable="false" />
      </basic>

      <many-to-many name="preferred">
        <join-table name="bw_authprefContacts">
          <join-column name="userid"/>
          <inverse-join-column name="contactid"/>
        </join-table>
      </many-to-many>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.svc.prefs.CalendarPref" >
    <attributes>
      <basic name="autoAdd" >
        <column name="autoaddCalendars" nullable="false" />
      </basic>

      <many-to-many name="preferred">
        <join-table name="bw_authprefCalendars">
          <join-column name="userid"/>
          <inverse-join-column name="calendarid"/>
        </join-table>
      </many-to-many>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.svc.prefs.BwAuthUserPrefs">
    <attributes>
      <embedded name="categoryPrefs" />

      <embedded name="locationPrefs"/>

      <embedded name="contactPrefs"/>

      <embedded name="calendarPrefs"/>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.BwDateTime" >
    <attributes>
      <basic name="dateType"/>

      <basic name="timezoneId"/>

      <basic name="dtval">
        <column length="16" />
      </basic>

      <basic name="date">
        <column length="16"/>
      </basic>

      <basic name="floatFlag"/>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.BwGeo" >
    <attributes>
      <basic name="latitude">
        <column name="bw_geolatitude"/>
      </basic>

      <basic name="longitude">
        <column name="bw_geolongitude"/>
      </basic>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.BwOrganizer">
    <attributes>
      <basic name="cn">
        <column name="bw_org_cn" length="500" />
      </basic>

      <basic name="dir">
        <column name="bw_org_dir" length="500" />
      </basic>

      <basic name="language">
        <column name="bw_org_lang" length="100" />
      </basic>

      <basic name="sentBy">
        <column name="bw_org_sentby" length="500" />
      </basic>

      <basic name="organizerUri">
        <column name="bw_org_uri" length="500" />
      </basic>

      <basic name="scheduleStatus">
        <column name="bw_org_sched_status" length="100"/>
      </basic>

      <basic name="dtstamp">
        <column name="bw_org_dtstamp" length="16" />
      </basic>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.BwRelatedTo" >
    <attributes>
      <basic name="relType">
        <column name="bw_reltype" length="100" />
      </basic>

      <basic name="value">
        <column name="bw_reltoval" length="500" />
      </basic>
    </attributes>
  </embeddable>

  <embeddable class="org.bedework.calfacade.BwRequestStatus" >
    <attributes>
      <basic name="code">
        <column name="bw_rscode" length="100" />
      </basic>

      <basic name="data">
        <column name="bw_rsdata" length="250" />
      </basic>

      <many-to-one name="description">
        <join-column name="bw_rsdescid"/>
      </many-to-one>
    </attributes>
  </embeddable>

  <!-- =========================================================
       A freebusy component in Bedework.
       ========================================================= -->

  <embeddable class="org.bedework.calfacade.BwFreeBusyComponent">
    <attributes>
      <basic name="type">
        <column name="bwtype"/>
      </basic>

      <basic name="value">
        <column name="bwvalue" length="3900" />
      </basic>
    </attributes>
  </embeddable>
</entity-mappings>